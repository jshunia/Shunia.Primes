\pdfoutput=1
\documentclass{article}
\usepackage{fullpage}
\usepackage{amsmath, amssymb, amsthm}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[numbers]{natbib}
\usepackage[usenames]{color}
\usepackage{url}
\usepackage{color}
\usepackage[usenames]{color}
\usepackage[usenames]{color}
\usepackage[colorlinks=true,
linkcolor=webgreen,
filecolor=webbrown,
citecolor=webgreen]{hyperref}
\definecolor{webgreen}{rgb}{0,.5,0}
\definecolor{webbrown}{rgb}{.6,0,0}
\definecolor{red}{rgb}{1,0,0}
\usepackage{cleveref}
\usepackage{tabularx}
\usepackage{placeins}
\theoremstyle{plain}
\newtheorem{conjecture}{Conjecture}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}{Remark}
\crefname{conjecture}{Conjecture}{Conjectures}
\crefname{theorem}{Theorem}{Theorems}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{proposition}{Proposition}{Propositions}
\crefname{remark}{Remark}{Remarks}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{notation}{Notation}
\newtheorem{example}{Example}
\newtheorem{question}{Question}
\crefname{definition}{Definition}{Definitions}
\crefname{notation}{Notation}{Notations}
\crefname{example}{Example}{Examples}
\crefname{question}{Question}{Questions}
\crefname{section}{\S}{Sections}
\newcommand{\ideal}[1]{\left\langle #1 \right\rangle}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\wt}[1]{\#(#1)}
\newcommand{\lcm}{\text{lcm}}
\newcommand{\ord}{\text{ord}}
\newcommand{\eval}[2]{\left . #1 \right|_{#2}}
\newcommand{\seqnum}[1]{\href{https://oeis.org/#1}{\rm \underline{#1}}}
\setlength{\parskip}{0.5em}
\setlength{\parindent}{0pt}

\title{An Efficient Deterministic Primality Test: Proof}
\author{Joseph M. Shunia}
\date{May 2024}

\begin{document}
\maketitle

\begin{theorem}
Let $n \in \mathbb{Z}^+$ be a Carmichael number. Hence, $n = p_1 p_2 \cdots p_m$ is odd, composite, and squarefree, where the $p_i$ are distinct odd prime factors.

Let $r \in \mathbb{Z}^+$ be the least odd prime such that $r \nmid n (n-1)$.

Consider the polynomial $f(x) := (x+1)^n - x^n - 1 \in \mathbb{Z}[x]$.

Let $(x^r-2, n)$ be the ideal generated by $x^r-2$ and $n$ in the polynomial ring $\mathbb{Z}[x]$.

Suppose $x^n \not\equiv x \pmod{(x^r-2,n)}$. Then
\begin{align*}
f(x) \not\equiv 0 \pmod{(x^r-2, n)}.
\end{align*}
\end{theorem}
\begin{proof}
The assumption $r \nmid n (n-1)$ implies that $r \nmid n$ and $r \nmid (n-1)$. First, we will show why this is necessary.

Suppose $r \mid n$, therefore $r = p$ where $p \mid n$. Then
\begin{align*}
    x^n \equiv 2 \pmod{(x^r-2, p)}
    \quad \Longrightarrow \quad
    (x+1)^n \equiv 3 \pmod{(x^r-2, p)} .
\end{align*}
Hence, we have trivially
\begin{align*}
    (x+1)^n - x^n - 1 \equiv 0 \pmod{(x^r-2, p)}
\end{align*}
Next, suppose $r \mid (n-1)$. Then $r \mid (p-1)$ for some $p \mid n$, and since $p$ is prime, $(p-1) = \phi(p)$. Leading to
\begin{align*}
    x^n \equiv x \pmod{(x^r-2, p)}
    \quad \Longrightarrow \quad
    (x+1)^n \equiv x+1 \pmod{(x^r-2, p)} .
\end{align*}
Again, we have trivially
\begin{align*}
    (x+1)^n - x^n - 1 \equiv 0 \pmod{(x^r-2, p)} .
\end{align*}

We will finish the proof by showing $f(x) \equiv 0 \pmod{(x^r-2, n)}$ leads to a contradiction under the given conditions.

Assume, for the sake of contradiction, that
\begin{align*}
    f(x) \equiv (x+1)^n - x^n - 1 \equiv 0 \pmod{(x^r-2, n)} .
\end{align*}

Since the congruence holds mod $(x^r-2, n)$, it must also hold mod $(x^r-2, p)$ for each prime factor $p$ of $n$. Otherwise, $n$ could not divide $f(x)$. Thus, for all primes $p \mid n$, we have
\begin{align*}
f(x) \equiv (x+1)^n - x^n - 1 \equiv (x+1)^p - x^p - 1 \equiv 0 \pmod{(x^r-2, p)} \\
\Longleftrightarrow (x+1)^n - x^n \equiv (x+1)^p - x^p \equiv 1 \pmod{(x^r-2, p)}
\end{align*}

From this, we deduce
\begin{align*}
\left( (x+1)^{n/p} - x^{n/p} \right)^p \equiv 1 \pmod{(x^r-2, p)}
\quad\Longrightarrow\quad
(x+1)^{n/p} - x^{n/p} \equiv 1 \pmod{(x^r-2, p)}
\end{align*}

Leading to
\begin{align*}
(x+1)^{n/p} - x^{n/p} \equiv (x+1)^n - x^n \equiv (x+1)^p - x^p \equiv 1 \pmod{(x^r-2, p)}
\end{align*}

This also implies
\begin{align*}
    \zeta_p \equiv (x+1)^{n/p} - x^{n/p} \pmod{(x^r-2, p)} ,
\end{align*}
where $\zeta_p$ is a $p$-th root of unity modulo $(x^r-2, p)$.

By the Chinese Remainder Theorem (CRT), since the congruences hold mod $(x^r-2, p)$ for each prime factor $p$ of $n$, they also hold mod $(x^r-2, n)$. Thus, we have
\begin{align*}
\zeta_n &\equiv (x+1)^{n/n} - x^{n/n} \pmod{(x^r-2, n)} \\
&\equiv (x+1)^1 - x^1 \pmod{(x^r-2, n)} \\
&\equiv (x+1) - x \pmod{(x^r-2, n)} \\
&\equiv 1 \pmod{(x^r-2, n)} .
\end{align*}
This is consistent with the possibility that $\zeta_p$ is a trivial $p$-th root of unity modulo $(x^r-2, n)$. That is
\begin{align*}
\zeta_p \equiv 1 \pmod{(x^r-2, p)} .
\end{align*}

Then, for each $p$, we must consider the following mutually exclusive cases:
\begin{enumerate}
\item[(i)] $x^p \equiv x^{n/p} \pmod{(x^r-2, p)} \quad\Longleftrightarrow\quad (x+1)^p \equiv (x+1)^{n/p} \pmod{(x^r-2, p)}$,
\item[(ii)] $x^n \equiv x^p \pmod{(x^r-2, p)} \quad\Longleftrightarrow\quad (x+1)^n \equiv (x+1)^p \pmod{(x^r-2, p)}$.
\end{enumerate}
Each case, taken individually, allows for $f(x) \equiv 0 \pmod{(x^r-2,p)}$. These cases are mutually exclusive, since satisfying both (i) and (ii) leads to
\begin{align*}
    x^{n/p} \equiv x^p \equiv x^n \pmod{(x^r-2, p)} ,
\end{align*}
implying that $p=r$ and $r \mid n$, contradicting the theorem.

Now, suppose cases (i), (ii) are both false. If $x^n \equiv \zeta_p x \pmod{(x^r-2, p)}$, where $\zeta_p$ is a non-trivial $p$-th root of unity modulo $(x^r-2, p)$, then $(x+1)^n \equiv \zeta_p (x+1) \pmod{(x^r-2, p)}$. This is possible because the polynomial ring $\mathbb{Z}[x]/(x^r-2, p)$ is isomorphic to the direct product of fields $\mathbb{F}_p[x]/(x-\alpha_1) \times \cdots \times \mathbb{F}_p[x]/(x-\alpha_r)$, where the $\alpha_i$ are the roots of $x^r-2$ in an algebraic closure of $\mathbb{F}_p$. In some of these fields, there may exist non-trivial $p$-th roots of unity, allowing for this. However, we showed above that $\zeta_n \equiv 1 \pmod{(x^r-2, n)}$, so this would imply $x^n \equiv \zeta_n x \equiv x \pmod{(x^r-2, n)}$, contradicting the assumption in the theorem that $x^n \not\equiv x \pmod{(x^r-2, n)}$.

Finally, suppose either case is true for all primes $p \mid n$. For $n$, the two cases (i) and (ii) collapse to a single case, since $p$ is replaced by $n$ in the exponents when lifting via the CRT:
\begin{align*}
x^n \equiv x \pmod{(x^r-2, n)} \quad\Longleftrightarrow\quad (x+1)^n \equiv x+1 \pmod{(x^r-2, n)}
\end{align*}
However, this is a contradiction, since again, $x^n \not\equiv x \pmod{(x^r-2, n)}$ by assumption in the theorem. Therefore $f(x) \not\equiv 0 \pmod{(x^r-2, n)}$. This completes the proof.
\end{proof}

\end{document}